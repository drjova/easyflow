{{extend 'layout.html'}}

{{block head}}
<script type="text/javascript">
  
	
	angular.module('workflows', []).
	 config(['$routeProvider', function($routeProvider) {
	  $routeProvider.
	      when('', {templateUrl: "{{=URL('static','templates/workflow/list.html')}}",   controller: workflowList}).
	      when('/edit/:workflowID', {templateUrl: "{{=URL('static','templates/workflow/details.html')}}", controller: workflowDetails}).
	      when('/create', {templateUrl: "{{=URL('static','templates/workflow/create.html')}}", controller: workflowCreate}).
	      when('/start/:workflowID', {templateUrl: "{{=URL('static','templates/workflow/list.html')}}",controller: workflowStart}).
	      otherwise({redirectTo: '/'});
	}]);
	 function workflowList($scope, $http) {
		  $http.get('http://127.0.0.1:8000/easyflow/workflow/view.json').success(function(data) {
		  	$scope.workflows = data.records;
		  });
		 
	 }
	 function workflowDetails($scope, $routeParams,$http) {
	 	$scope.workflowID = $routeParams.workflowID;
		$http.get("{{=URL('workflow','single.json')}}" +'/'+ $routeParams.workflowID).success(function(data) {
   			$scope.workflow = data.records
  		});
	 	
	  		
	  }
	  function workflowCreate(){
	  		
	  }
	  function workflowStart($scope,$routeParams,$http){
	  	$scope.workflowID = $routeParams.workflowID;

	  	$http.get("{{=URL('workflow','start.json')}}?workflow_id="+$scope.workflowID).success(function(data) {
   			console.log(data);
  		});
	  }


	</script>

{{end}}

<h2> {{= title}}</h2>
<div class="">

	<a href="#create">Create new workflow</a>

<div class="wrokflows-list">
	 <div ng-view></div>
</div>
</div>

